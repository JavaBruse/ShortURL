# 1. Как пользоваться сервисом:
1. Вы можете открывать доступные Вам короткие ссылки на любом этапе программы.
2. Авторизуйтесь, ввдея имя, либо ранее выданный UUID. 

Теперь Вам доступно:
3. Удаление ссылки - удалить можно только ссылки которые соответсвуют Вашему UUID
4. Просмотр ссылок - посмотреть можно любые ссылки, но при открытии личных ссылок их лимит изменен не будет.
5. Ооздание ссылок - можно создавать ссылки, которые соответствую "валидации", ссылка должна быть сссылкой, а не набором букв:
```shell
http://example.com минимальный URL
http://127.0.0.1 с IP вместо доменного имени
http://example.com:8080 с портом
http://example.com/path/to/resource с путем
http://example.com?param1=value1&param2=value2 с query-параметрами
http://example.com#top с якорем
https://example.com:443/path/to/resource?key=value#section полный URL
```
Так же Вы можете задать время жизни ссылки в формате часы:минуты.
Ограницений в данном виде нет, можно задать 100 часов и 500 минут, код отработает кооректно, 100 будет приобразована в чаты 500 в минуты, однако если это значение 
будет больше максимально разрешенного в конфиге, то применится значение из конфига.
# 2. Какие команды поддерживаются:
При первом запуске программы, доступны следующие команды:

[shortUrl]                    -  откроет коротку ссылку, если она валидна

-n [имя пользователя]         -  создание нового пользователя

-u [UUID]                     -  вход по UUID

exit                          -  выход

После авторизации, список доступных команд будет такого вида:

-l [URL]                      - создание короткой ссылки, без параметров.

-l [URL] [часы:минуты]        - параметр существования ссылки, например: 5:10 где 5 часов, 10 минут.

-rm [адресс короткой ссылки]  - удаление короткой строки

all                           - все мои ссылки.

exit                          - выход
# 3. Как протестировать ваш код:
1. Создайте нового пользователя -n [имя пользователя],
2. Создайте новую ссылку -l [URL],
3. Посмотрите Ваши ссылки all,
4. Перейдите по ссылке, ввдея короткую ссылку в терминале, при этом лимит переходов изменен не будет.
5. Можете перезапустить приложение и вновь ввести короткую ссылку, тогда изменится её лимит переходов.
6. Авторизуйте, и посмотрите лимит переходов.
7. Создайте новую ссылку -l [URL] 0:1 c временем жизни 1 минута.
8. Выйдите из приложение и вновь попробуйте по ней перейти, она будет доступна 1 минут с момента её создания, далее будет сообщение о её не доступности и ссылка будет удалена.
9. Авторизуйтесь по UUID
10. Удалите ссылку -rm [адресс короткой ссылки],
11. Убедитесь, что ссылка удалена all,
# 4. Подготовка к отправке проекта на проверку:

1. Функциональность (1 балл)

Алгоритм сокращения ссылки должен корректно работать и возвращать уникальную короткую ссылку для каждого пользователя.

Генератор короткой ссылки представлен ниже, так же добавлена проверка её уникальности, относительно уже существующих ссылко:
```java
private String generateNewShortLink() {
        String dict = "qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM1234567890"; //строка содержит все доступные символы
        StringBuilder sb = new StringBuilder("http://clck.ru/");
        int max = dict.length() - 1;
        int min = 0;
        while (true) {
            for (int i = 0; i < 6; i++) {
                int number = randomMinMax(min, max);
                sb.append(dict.substring(number, number + 1));
            }
            Optional<Link> optionalLink = linkDAO.findLongByShortLink(sb.toString()); //поиск ссылки в БД
            if (!optionalLink.isPresent()) {  // если такой ссылки нет, то отправляем иначе генерируем новую.
                return sb.toString();  // http://clck.ru/6R9kln 
            }
        }
    }
```
2. Внесение основных параметров работы алгоритма в конфигурационный файл  (2 балла)

При добавлении ссылки пользователь может указать время существования ссылки. Фактическое время хранения должно быть ограничено меньшим из введённых пользователем 
значений или значений, заданных в конфигурационном файле. Необходимо реализовать возможность подключения конфигурации из отдельного файла, чтобы параметры могли 
быть изменены без изменения кода.

Это гарантируется следующими командами:
```shell
-l [URL]                      - создание короткой ссылки, без параметров.
-l [URL] [часы:минуты]        - параметр существования ссылки, например: 5:10 где 5 часов, 10 минут.
```
config.ini создается при первом запуске программы, и используется при последующих на проверку его изменений.
```xml
[Settings]
limit = 10
Life_day = 5
```

3. Ограничение по времени жизни (2 балла)
- Реализована функция автоматического удаления ссылки по истечении её срока действия.
4. Автоматическое удаление ссылок (2 балла)
- Ссылки удаляются по достижении лимита переходов или истечении времени жизни.

Автоматическое удаление ссылки реализовано в этом методе класса LinkService:
```java
  public Link getLongLink(String shortLink) {
        try {
            Link link = null;
            if (shortLink.substring(0, 8).equals(source)) {
                link = findLongLink("http://" + shortLink);

            } else if (shortLink.substring(0, 15).equals(sourceAndHTTP)) {
                link = findLongLink(shortLink);
            }
            if (link.getDateEnd() < new Date().getTime()) { // Проверяет ссылку на оставшееся времяи удаляет её если оно меньше настоящего времени.
                linkDAO.deleteById(link.getId()); 
                throw new TimeErrorException("Время активности ссылки истекло, ссылка удалена!");
            }
            if (link.getTransitionLimit() <= 0) { // Если лимит равен 0, ссылка будет удалена.
                linkDAO.deleteById(link.getId());
                throw new LimitIsOverException("Лимит на переходы истек, ссылка удалена!");
            }
            return link;
        } catch (NotFoundEntityException | NullPointerException e) {
            System.err.println(e);
        }
        return null;
    }
```
Так же отмечу, что при просмотре ссвоих ссылок, если на момент сработы тригера удаления ей  не кто не воспользовался, то она будет видна при вводе команды all
```shell
Длинная ссылка: https://example.com, короткая ссылка: http://clck.ru/FWTHhd, Оставшееся время жизни ссылки: 6 дней, 22 ч 9 м 17 сек, Осталось переходов: 0
```
Переход по ней будет заблокирован, и ссылка будет удалена, при этой попытке.

5. Уникальность ссылок (2 балла)

Разные пользователи получают разные короткие ссылки на один и тот же URL.
Тут показана часть кода, метода генерации новой ссылки, где видно если ссылка уже существует, то генерация будет повторятся.
```java
while (true) {
            for (int i = 0; i < 6; i++) {
                int number = randomMinMax(min, max);
                sb.append(dict.substring(number, number + 1));
            }
            Optional<Link> optionalLink = linkDAO.findLongByShortLink(sb.toString()); //поиск ссылки в БД
            if (!optionalLink.isPresent()) {  // если такой ссылки нет, то отправляем иначе генерируем новую.
                return sb.toString();  // http://clck.ru/6R9kln 
            }
        }
```

6. Повторное создание ссылок (2 балла)

При повторном запросе сокращения той же ссылки, пользователю должна быть сгенерирована новая ссылка.

В коде нет проверки на уникальность длинных ссылок, на любые одинаковые ссылки, будет выдана новая короткая ссылка. 

7. Переход по ссылке (2 балла)

При вводе короткой ссылки в консоль должен осуществляться переход на оригинальный ресурс.

Ввдите ранее выданную или известную короткую ссылку вида "http://clck.ru/O9FnlC", после чего ссылка будет открыта в браузере. Авторизация по UUID не требуется.
Если её нет, или лимиты истекли, вы получите соответсвующее уведомление.

8. Лимит переходов (2 балла)

Ссылка должна блокироваться после достижения заданного пользователем лимита переходов. Пользователь вводит этот лимит и, в 
зависимости от заданного времени существования ссылки, система выбирает большее из введённого пользователем значения и значения,
заданного в конфигурационном файле.

Не блокируется, а полностью удаляется, как написано в пункте 4., если удаление можно назвать блокировкой ссылки, то она блокируется.
Лимит перехода по ссылке будет запрошен при её создании, если он окажется больше чем в лимита в конфиге, то будет выбран меньший, 
могу изменить на условие "система выбирает большее из введённого пользователем значения и значения,
заданного в конфигурационном файле.", но мне кажется, что тут ошибка в задании, и если ввдененый лимит превыщает лимит конфигна, то должен быть выбран лимит конфига".
Это не важно, данный функционал реализован. Если треубется выбирать большее значение, то нужно поменять знак в условии:
```java
        if (limit < Settings.getInstance().getLIMIT()) { //Тут изменен знак для того, что бы подходило под условие. 
    // Надеюсь по этому вопросу не будет отправлено на доработку из одного знака..
            link.setTransitionLimit(Settings.getInstance().getLIMIT());
        } else {
            link.setTransitionLimit(limit);
        }
```

9. Уведомление пользователя (2 балла)

Пользователь получает уведомление, когда ссылка становится недоступной из-за лимита переходов или истечения времени жизни.

При попытке перехода, пользователь получит уведомление что ссылка отсутсвует если её уже удалили, и если у нее истек срок годности или лимит, 
то она будет удалена при этом запросе короткой ссылки и пользователь получит соответствующее уведомление см.Пример.
```shell
http://clck.ru/RUozxt
Лимит на переходы истек, ссылка удалена!
http://clck.ru/RUozxt
Нет такой ссылки: http://clck.ru/RUozxt
http://clck.ru/RUozxt
Нет такой ссылки: http://clck.ru/RUozxt
```

10. Редактирование лимита переходов (2 балла)

У пользователя есть возможность изменять лимит переходов по ссылке.

Есть возможность изменять лимит переходов в конфиге, перед созданием, а так же во время создания, можно задать лимит переходов.
При изменение конфига, требуется перезагрузка приложения.

11. Удаление ссылки (2 балла)

Пользователь может удалять свои ссылки.

это реализовано коммандой:
```shell
-rm [адресс короткой ссылки]  - удаление короткой строки
```

12. Идентификация по UUID (2 балла)

Возможность редактирования и удаления ссылки должна быть доступна только её создателю, идентифицируемому по UUID.

Есть возможность удалить ссылку только её владельцу по UUID.

13. Работа нескольких пользователей (2 балла)

Сервис поддерживает работу нескольких пользователей, каждый из которых может создавать уникальные короткие ссылки.

Сколько угодно пользователеё может открывать, проходить регистрацию и пользоваться короткими ссылками даже без регистрации.

14. Администрирование параметров ссылки (2 балла)

Только создатель ссылки может редактировать её параметры или удалять её.

Может.

15. Создание нескольких ссылок (2 балла)

Один пользователь может создавать несколько коротких ссылок на разные ресурсы.

Может.

16. Идентификация по UUID при повторных запросах (2 балла)

Система идентифицирует пользователя по UUID и генерирует уникальную ссылку при каждом запросе.

Вход по UUID гарантируется командой.
```shell
-u [UUID]                     -  вход по UUID
```
Как генерируется уникальная ссылка, описано выше.
